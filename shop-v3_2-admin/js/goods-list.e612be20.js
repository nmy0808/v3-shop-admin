"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[658,888,500],{62128:function(e,a,t){t.r(a),t.d(a,{default:function(){return P}});var l=t(66252),n=t(2262),i=t(3577),s=t(12128),r=t(8047),o=t(49843),c=t(14645),d=t(64286),u=t(43560),p=t(93098),m=t(4984),f=t(7599);const g={class:"flex"},k={class:"ml-4"},h={class:"text-xl font-semibold"},w={class:"opacity-60"},S={class:"text-red-500 font-bold"},U=(0,l.Uk)(" 上架 "),v=(0,l.Uk)(" 仓库 "),D={key:0,class:"text-green-500"},_={key:1,class:"text-red-500"},y={key:2,class:"flex flex-col flex-wrap w-20 mx-auto relative -left-6px"},C=(0,l.Uk)("审核通过"),b=(0,l.Uk)("审核拒绝"),W=(0,l.Uk)("编辑"),z=(0,l.Uk)("商品规格"),L=(0,l.Uk)("设置轮播图"),R=(0,l.Uk)("商品详情"),x=(0,l.Uk)("删除"),H=()=>{const e=(0,n.iH)({title:"",category_id:"",tab:"all"}),{loading:a,list:t,pageSearch:l,total:i,getListData:s,deleteData:r,statusData:c}=(0,m.F)({listSearchParams:e,listDataApi:o.goodsListApi,deleteDataApi:o.goodsBatchDeleteApi,statusDataApi:o.goodsCheckApi}),d=async(e,a)=>{try{e.checkLoading=!0;const t={id:e.id,ischeck:a};await(0,o.goodsCheckApi)(t),await s(),(0,f.t6)({message:1===a?"已同意":"已拒绝",type:"success"})}finally{e.checkLoading=!1}},u=a=>{e.value={...e.value,...a},s()};return{list:t,loading:a,pageSearch:l,total:i,listSearchParams:e,getUserListData:s,handleStatusChange:d,handleSearch:u,handleDelete:r}},A=()=>{const e=(0,n.iH)(null),a=()=>{e.value.open({title:"新增"})},t=a=>{e.value.open({title:"编辑",data:a})},l=(0,n.iH)(null),i=e=>{l.value.open({title:"编辑轮播图",data:e})},s=(0,n.iH)(null),r=e=>{s.value.open({title:"编辑商品详情",data:e})},o=(0,n.iH)(null),c=e=>{o.value.open({title:"编辑商品规格",data:e})};return{actionDrawerRef:e,handleCreate:a,handleEdit:t,setBannerDrawerRef:l,handleBanner:i,setContentDrawerRef:s,handleContent:r,setSkusDrawerRef:o,handleSkus:c}};var B={__name:"index",setup(e){const{list:a,loading:t,pageSearch:o,total:m,listSearchParams:f,handleStatusChange:B,getUserListData:N,handleSearch:P,handleDelete:j}=H(),{actionDrawerRef:O,handleCreate:V,handleEdit:E,setBannerDrawerRef:F,handleBanner:T,setContentDrawerRef:K,handleContent:Y,setSkusDrawerRef:q,handleSkus:G}=A(),I=(0,n.iH)(r.tableOptions.value),J=(0,n.iH)([]);N().then((e=>{J.value=e.cates}));const M=[{label:"全部",name:"all"},{label:"审核中",name:"checking"},{label:"出售中",name:"saling"},{label:"已下架",name:"off"},{label:"库存预警",name:"min_stock"},{label:"回收站",name:"delete"}],Q=e=>{o.value.page=1,a.value=[],"delete"==f.value.tab?I.value=[...r.tableOptions.value].filter((e=>"ischeck"!==e.prop)):I.value=[...r.tableOptions.value],N()};return(e,r)=>{const H=(0,l.up)("el-tab-pane"),A=(0,l.up)("el-tabs"),X=(0,l.up)("NSearchHeader"),Z=(0,l.up)("NActionHeader"),$=(0,l.up)("NAvatar"),ee=(0,l.up)("el-divider"),ae=(0,l.up)("el-tag"),te=(0,l.up)("el-button"),le=(0,l.up)("NTable"),ne=(0,l.up)("NContainer");return(0,l.wg)(),(0,l.j4)(ne,null,{default:(0,l.w5)((()=>[(0,l.Wm)(A,{modelValue:(0,n.SU)(f).tab,"onUpdate:modelValue":r[0]||(r[0]=e=>(0,n.SU)(f).tab=e),"tab-position":"top",onTabChange:Q},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(M,((e,a)=>(0,l.Wm)(H,{key:a,label:e.label,name:e.name},null,8,["label","name"]))),64))])),_:1},8,["modelValue"]),(0,l.Wm)(X,{class:"mt-4",schema:(0,n.SU)(s.searchSchema),showFold:!0,onSearch:(0,n.SU)(P)},null,8,["schema","onSearch"]),(0,l.Wm)(Z,{onCreate:(0,n.SU)(V),onRefresh:(0,n.SU)(N)},null,8,["onCreate","onRefresh"]),(0,l.Wm)(le,{"table-layout":"auto",ref:"tableRef",data:(0,n.SU)(a),options:I.value,dragSort:!1,loading:(0,n.SU)(t),total:(0,n.SU)(m),currentPage:(0,n.SU)(o).page,"onUpdate:currentPage":r[1]||(r[1]=e=>(0,n.SU)(o).page=e),pageSize:(0,n.SU)(o).limit,"onUpdate:pageSize":r[2]||(r[2]=e=>(0,n.SU)(o).limit=e)},(0,l.Nv)({info:(0,l.w5)((({row:e})=>[(0,l._)("div",g,[(0,l.Wm)($,{src:e.cover,class:"rounded-10px w-30 h-30"},null,8,["src"]),(0,l._)("div",k,[(0,l._)("div",h,(0,i.zw)(e.title),1),(0,l._)("div",w,[(0,l._)("span",S,"¥"+(0,i.zw)(e.min_price),1),(0,l.Wm)(ee,{direction:"vertical"}),(0,l._)("span",null,"¥"+(0,i.zw)(e.min_oprice),1)]),(0,l._)("div",null," 分类: "+(0,i.zw)(J.value.find((a=>a.id===e.category_id))?.name),1),(0,l._)("div",null," 创建时间: "+(0,i.zw)(e.create_time),1)])])])),status:(0,l.w5)((({row:e})=>[1==e.status?((0,l.wg)(),(0,l.j4)(ae,{key:0,type:"success",size:"small",effect:"light"},{default:(0,l.w5)((()=>[U])),_:1})):((0,l.wg)(),(0,l.j4)(ae,{key:1,type:"",size:"small",effect:"light"},{default:(0,l.w5)((()=>[v])),_:1}))])),ischeck:(0,l.w5)((({row:e})=>[1===e.ischeck?((0,l.wg)(),(0,l.iD)("span",D,"通过")):2===e.ischeck?((0,l.wg)(),(0,l.iD)("span",_,"拒绝")):((0,l.wg)(),(0,l.iD)("div",y,[(0,l.Wm)(te,{class:"!ml-0",type:"success",size:"small",plain:"",onClick:a=>(0,n.SU)(B)(e,1),loading:e.checkLoading},{default:(0,l.w5)((()=>[C])),_:2},1032,["onClick","loading"]),(0,l.Wm)(te,{class:"!ml-0 mt-4",type:"danger",size:"small",plain:"",onClick:a=>(0,n.SU)(B)(e,2),loading:e.checkLoading},{default:(0,l.w5)((()=>[b])),_:2},1032,["onClick","loading"])]))])),_:2},["delete"!==(0,n.SU)(f).tab?{name:"action",fn:(0,l.w5)((({row:e})=>[(0,l.Wm)(te,{type:"primary",link:"",size:"small",onClick:a=>(0,n.SU)(E)(e)},{default:(0,l.w5)((()=>[W])),_:2},1032,["onClick"]),(0,l.Wm)(te,{type:"primary",link:"",size:"small",onClick:a=>(0,n.SU)(G)(e)},{default:(0,l.w5)((()=>[z])),_:2},1032,["onClick"]),(0,l.Wm)(te,{type:"primary",link:"",size:"small",onClick:a=>(0,n.SU)(T)(e)},{default:(0,l.w5)((()=>[L])),_:2},1032,["onClick"]),(0,l.Wm)(te,{type:"primary",link:"",size:"small",onClick:a=>(0,n.SU)(Y)(e)},{default:(0,l.w5)((()=>[R])),_:2},1032,["onClick"]),(0,l.Wm)(te,{type:"danger",link:"",size:"small",onClick:a=>(0,n.SU)(j)({ids:[e.id]})},{default:(0,l.w5)((()=>[x])),_:2},1032,["onClick"])]))}:void 0]),1032,["data","options","loading","total","currentPage","pageSize"]),(0,l.Wm)(c["default"],{ref_key:"actionDrawerRef",ref:O,getListData:(0,n.SU)(N)},null,8,["getListData"]),(0,l.Wm)(d["default"],{ref_key:"setBannerDrawerRef",ref:F,getListData:(0,n.SU)(N)},null,8,["getListData"]),(0,l.Wm)(u["default"],{ref_key:"setContentDrawerRef",ref:K,getListData:(0,n.SU)(N)},null,8,["getListData"]),(0,l.Wm)(p["default"],{ref_key:"setSkusDrawerRef",ref:q,getListData:(0,n.SU)(N)},null,8,["getListData"])])),_:1})}}};const N=B;var P=N}}]);