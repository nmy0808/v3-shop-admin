"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[9],{38314:function(e,a,l){l.r(a),l.d(a,{default:function(){return V}});var t=l(66252),n=l(2262),i=l(3577),s=l(73664),o=l(2362),r=l(93067),c=l(68022),d=l(2973),u=l(4984),m=l(46377),p=l(93162),w=l(7599);const f=(0,t.Uk)("彻底删除"),g={class:"flex items-center"},h=(0,t._)("div",{class:"w-20 inline-block opacity-60"},"订单号:",-1),S=(0,t._)("div",{class:"w-20 inline-block opacity-60"},"下单时间:",-1),k={class:"flex items-center mt-4"},_={class:"ml-4 color-primary"},U=(0,t._)("span",{class:"mr-2"},"付款状态:",-1),y=(0,t.Uk)("支付宝支付 "),b=(0,t.Uk)("未支付"),v={class:"mt-2"},C=(0,t._)("span",{class:"mr-2"},"发货状态:",-1),D=(0,t.Uk)("未发货"),z=(0,t.Uk)("已发货"),W={class:"mt-2"},j=(0,t._)("span",{class:"mr-2"},"收货状态:",-1),A=(0,t.Uk)("未收货 "),O=(0,t.Uk)("已收货"),x={class:"flex justify-end w-68"},L=(0,t.Uk)("订单详情"),R=(0,t.Uk)("订单发货"),H=(0,t.Uk)("同意退款"),P=(0,t.Uk)("拒绝退款"),T=()=>{const e=(0,n.iH)({no:"",tab:"all",starttime:null,endtime:null,name:"",phone:""}),a=[{label:"全部",name:"all"},{label:"待支付",name:"nopay"},{label:"待发货",name:"noship"},{label:"已发货",name:"shiped"},{label:"已收货",name:"received"},{label:"已完成",name:"finish"},{label:"已关闭",name:"closed"},{label:"退款中",name:"refunding"}],{loading:l,list:t,pageSearch:i,total:s,getListData:o,deleteData:c,statusData:d}=(0,u.F)({listSearchParams:e,listDataApi:r.orderListApi,deleteDataApi:r.orderBatchDeleteApi,statusDataApi:r.orderStatusApi}),m=(0,n.iH)([]),f=e=>{m.value=[...e]},g=()=>{c({ids:m.value.map((e=>e.id))})},h=a=>{e.value={...e.value,...a},o()},S=async()=>{o()},k=async()=>{const a=await(0,r.orderExportApi)({...e.value});let l=window.URL.createObjectURL(new Blob([a])),t=(new Date).getTime()+".xlsx";(0,p.saveAs)(l,t)},_=async(e,a)=>{try{const l={};l.id=e.id,l.agree=a;let t="同意退款操作完成";1!==a&&(l.disagree_reason=await(0,w.eB)({title:"拒绝退款",message:"请输入拒绝退款的理由",closeOnClickModal:!1,closeOnPressEscape:!1,beforeClose:(e,a,l)=>{const t=a.inputValue?.trim();if(t)return l();(0,w.yw)({message:"必须填写拒绝退款的理由",type:"error"})}}),t="拒绝退款操作完成"),await(0,r.orderStatusApi)(l),(0,w.t6)({message:t,type:1===a?"success":"error"})}catch(l){}};return{tabOptions:a,listSearchParams:e,list:t,loading:l,pageSearch:i,total:s,handleSelectChange:f,handleBatchDelete:g,getListData:o,handleStatusChange:_,handleSearch:h,handleDelete:c,handleTabClick:S,handleDownload:k}},B=()=>{const e=(0,n.iH)(null),a=a=>{e.value.open({title:"订单发货",data:a})},l=(0,n.iH)(null),t=e=>{l.value.open({title:"订单信息",data:e})};return{actionDrawerRef:e,handleOrderSend:a,handleOrderInfo:t,orderInfoDrawerRef:l}};var I={__name:"index",setup(e){const{tabOptions:a,listSearchParams:l,list:r,loading:u,pageSearch:p,total:w,handleSelectChange:I,handleBatchDelete:N,getListData:V,handleSearch:q,handleDownload:E,handleTabClick:F,handleStatusChange:Y}=T();V();const{actionDrawerRef:K,handleOrderSend:M,handleOrderInfo:G,orderInfoDrawerRef:J}=B();return(e,T)=>{const B=(0,t.up)("el-tab-pane"),Q=(0,t.up)("el-tabs"),X=(0,t.up)("NSearchHeader"),Z=(0,t.up)("el-button"),$=(0,t.up)("NActionHeader"),ee=(0,t.up)("el-divider"),ae=(0,t.up)("NAvatar"),le=(0,t.up)("el-tag"),te=(0,t.up)("NTable"),ne=(0,t.up)("NContainer");return(0,t.wg)(),(0,t.j4)(ne,null,{default:(0,t.w5)((()=>[(0,t.Wm)(Q,{modelValue:(0,n.SU)(l).tab,"onUpdate:modelValue":T[0]||(T[0]=e=>(0,n.SU)(l).tab=e),"tab-position":"top",onTabChange:(0,n.SU)(F)},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(a),((e,a)=>((0,t.wg)(),(0,t.j4)(B,{key:a,label:e.label,name:e.name},null,8,["label","name"])))),128))])),_:1},8,["modelValue","onTabChange"]),(0,t.Wm)(X,{class:"my-4",schema:(0,n.SU)(s.searchSchema),showFold:!1,formOptions:{labelWidth:"60px",size:"small",inline:!0},onSearch:(0,n.SU)(q)},null,8,["schema","onSearch"]),(0,t.Wm)($,null,{left:(0,t.w5)((()=>[(0,t.Wm)(Z,{type:"danger",size:"small",onClick:(0,n.SU)(N)},{default:(0,t.w5)((()=>[f])),_:1},8,["onClick"])])),right:(0,t.w5)((()=>[(0,t.Wm)(Z,{size:"small",icon:"el-icon-download",onClick:(0,n.SU)(E)},null,8,["onClick"]),(0,t.Wm)(Z,{size:"small",icon:"el-icon-refresh",onClick:(0,n.SU)(V)},null,8,["onClick"])])),_:1}),(0,t.Wm)(te,{"table-layout":"auto",ref:"tableRef",data:(0,n.SU)(r),options:(0,n.SU)(o.tableOptions),dragSort:!1,loading:(0,n.SU)(u),total:(0,n.SU)(w),currentPage:(0,n.SU)(p).page,"onUpdate:currentPage":T[1]||(T[1]=e=>(0,n.SU)(p).page=e),pageSize:(0,n.SU)(p).limit,"onUpdate:pageSize":T[2]||(T[2]=e=>(0,n.SU)(p).limit=e),onSelectionChange:(0,n.SU)(I)},{"goods-info":(0,t.w5)((({row:e})=>[(0,t._)("div",g,[(0,t._)("div",null,[h,(0,t._)("div",null,(0,i.zw)(e.no),1)]),(0,t.Wm)(ee,{class:"mx-6",direction:"vertical"}),(0,t._)("div",null,[S,(0,t._)("div",null,(0,i.zw)(e.create_time),1)])]),(0,t._)("div",k,[(0,t.Wm)(ae,{src:e?.order_items[0]?.goods_item?.cover,class:"rounded-1px w-10 h-10"},null,8,["src"]),(0,t._)("div",_,(0,i.zw)(e?.order_items[0]?.goods_item?.title),1)])])),user:(0,t.w5)((({row:e})=>[(0,t._)("div",null,[(0,t._)("div",null,(0,i.zw)(e.user.username),1),(0,t._)("div",null,"(用户id: "+(0,i.zw)(e.user.id)+")",1)])])),"status-info":(0,t.w5)((({row:e})=>[(0,t._)("div",null,[U,e.payment_method===(0,n.SU)(m.f)?((0,t.wg)(),(0,t.j4)(le,{key:0,class:"w-30",type:"",size:"small",effect:"light"},{default:(0,t.w5)((()=>[y])),_:1})):((0,t.wg)(),(0,t.j4)(le,{key:1,class:"w-30",type:"info",size:"small",effect:"light"},{default:(0,t.w5)((()=>[b])),_:1}))]),(0,t._)("div",v,[C,"pending"===e.ship_status?((0,t.wg)(),(0,t.j4)(le,{key:0,class:"w-30",type:"info",size:"small",effect:"light"},{default:(0,t.w5)((()=>[D])),_:1})):((0,t.wg)(),(0,t.j4)(le,{key:1,class:"w-30",type:"success",size:"small",effect:"light"},{default:(0,t.w5)((()=>[z])),_:1}))]),(0,t._)("div",W,[j,"pending"===e.refund_status?((0,t.wg)(),(0,t.j4)(le,{key:0,class:"w-30",type:"info",size:"small",effect:"light"},{default:(0,t.w5)((()=>[A])),_:1})):((0,t.wg)(),(0,t.j4)(le,{key:1,class:"w-30",type:"success",size:"small",effect:"light"},{default:(0,t.w5)((()=>[O])),_:1}))])])),action:(0,t.w5)((({row:e})=>[(0,t._)("div",x,[e.payment_method||"all"!==(0,n.SU)(l).tab?((0,t.wg)(),(0,t.j4)(Z,{key:0,type:"primary",link:"",size:"small",onClick:a=>(0,n.SU)(G)(e)},{default:(0,t.w5)((()=>[L])),_:2},1032,["onClick"])):(0,t.kq)("",!0),"all"===(0,n.SU)(l).tab||"noship"===(0,n.SU)(l).tab?((0,t.wg)(),(0,t.j4)(Z,{key:1,type:"primary",link:"",size:"small",onClick:a=>(0,n.SU)(M)(e)},{default:(0,t.w5)((()=>[R])),_:2},1032,["onClick"])):(0,t.kq)("",!0),"refunding"===(0,n.SU)(l).tab?((0,t.wg)(),(0,t.iD)(t.HY,{key:2},[(0,t.Wm)(Z,{type:"primary",link:"",size:"small",onClick:a=>(0,n.SU)(Y)(e,1)},{default:(0,t.w5)((()=>[H])),_:2},1032,["onClick"]),(0,t.Wm)(Z,{type:"primary",link:"",size:"small",onClick:a=>(0,n.SU)(Y)(e,0)},{default:(0,t.w5)((()=>[P])),_:2},1032,["onClick"])],64)):(0,t.kq)("",!0)])])),_:1},8,["data","options","loading","total","currentPage","pageSize","onSelectionChange"]),(0,t.Wm)(c["default"],{ref_key:"actionDrawerRef",ref:K,getListData:(0,n.SU)(V)},null,8,["getListData"]),(0,t.Wm)(d["default"],{ref_key:"orderInfoDrawerRef",ref:J,getListData:(0,n.SU)(V)},null,8,["getListData"])])),_:1})}}};const N=I;var V=N}}]);